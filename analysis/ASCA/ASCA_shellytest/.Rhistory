install.packages("MetStaT")
library(MetStaT)
?ASCA.Calculate
data(ASCAdata)
ASCA <- ASCA.Calculate(ASCAX, ASCAF, equation.elements = "1,2,12", scaling = FALSE)
View(ASCAX)
View(ASCAF)
ASCA.Plot(ASCA)
ASCA <- ASCA.Calculate(ASCAX, ASCAF, equation.elements = "1", scaling = FALSE)
ASCA.Plot(ASCA)
ASCA.Plot(ASCA)
ASCA.Plot(ASCA)
ASCA.PlotScores(ASCA)
ASCA.PlotLoadings(ASCA)
ASCA.GetPlotLoadings(ASCA)
ASCA.GetSummary(ASCA)
ASCA.PlotScoresPerLevel(ASCA, ee = "2", pcs = "1,2")
ASCA.PlotScoresPerLevel(ASCA, ee = "1", pcs = "1")
ASCA <- ASCA.Calculate(ASCAX, ASCAF, equation.elements = "1,2,12", scaling = FALSE)
ASCA.PlotScoresPerLevel(ASCA, ee = "2", pcs = "1,2")
read.csv("~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv/")
read.csv("~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv")
data <- read.csv("~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv")
View(dat)
View(data)
data$silo <- substr(data$Protein,1,1)
data$Protein <- substr(data$Protein, 3, nchar(data$Protein))
data$Protein <- substr(data$Protein, 3, nchar(data[,1]))
nchar(data$Protein[1])
class(data$Protein)
class(data$Protein) <- "character"
data$Protein <- substr(data$Protein, 3, nchar(data$Protein))
data <- read.csv("~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv")
data$silo <- substr(data$Protein,1,1)
class(data$Protein) <- "character"
nchar(data$Protein)[1]
View(nchar(data$Protein))
View(data.framenchar(data$Protein)))
View(data.frame(nchar(data$Protein)))
data <- read.csv("~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv")
data$silo <- substr(data$Protein,1,1)
View(as.character(unlist(data$Protein))
View(as.character(unlist(data$Protein)))
View(data.frame(as.character(unlist(data$Protein))))
data$Protein <- data.frame(as.character(unlist(data$Protein)))
View(data)
data$Protein <- as.character(unlist(data$Protein))
View(data)
data$Protein <- substr(data$Protein, 3, nchar(data$Protein))
View(data)
library(dplyr)
library(tidyr)
View(tidyr::gather(data, key = "silo", value = "Protein"))
View(tidyr::gather(data, key = "Protein", value = "silo"))
View(tidyr::gather(data, key = "Protein", value = "silo", c(1,10)))
View(tidyr::gather(data, key = "silo", value = "Protein", c(1,10)))
View(tidyr::gather(data, key = "silo", value = "Protein", -1)
View(tidyr::gather(data, key = "silo", value = "Protein", -1))
View(tidyr::gather(data, key = "silo", value = "Protein", c(-1)))
View(tidyr::gather(data, key = "silo", value = "Protein", c(10)))
data3 <- data[which(data$silo ==3),]
data9 <- data[which(data$silo ==9),]
View(data9)
View(data3)
View(merge(data3,data9, by= "Protein", all.y = TRUE ))
data <- read.csv("~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv")
data$Protein <- as.character(unlist(data$Protein))
data$Protein <- substr(data$Protein, 3, nchar(data$Protein))
data3 <- data[which(data$silo ==3),]
data9 <- data[which(data$silo ==9),]
merge(data3,data9, by= "Protein", all.y = TRUE )
data_mrg <-merge(data3,data9, by= "Protein", all.y = TRUE )
View(data_mrg)
data <- read.csv("~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv")
data$silo <- substr(data$Protein,1,1)
data$Protein <- as.character(unlist(data$Protein))
data$Protein <- substr(data$Protein, 3, nchar(data$Protein))
data3 <- data[which(data$silo ==3),]
data9 <- data[which(data$silo ==9),]
merge(data3,data9, by= "Protein", all.y = TRUE )
data_mrg <- merge(data3,data9, by= "Protein", all.y = TRUE )
data <- read.csv("~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv")
View(data)
data <- read.csv("~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv")
data$silo <- substr(data$Protein,1,1)
data$Protein <- as.character(unlist(data$Protein))
data$Protein <- substr(data$Protein, 3, nchar(data$Protein))
View(tidyr::spread(data, abundance, time, c(2:9)))
View(tidyr::gather(data, "Protein",time, c(2:9)))
View(tidyr::gather(data, "Protein",time, c(1:9)))
View(tidyr::gather(data, "Protein","time", c(1:9)))
View(tidyr::gather(data, "time", "Protein", c(1:9)))
View(tidyr::gather(data, "time", "Protein", c(1:9)))
View(tidyr::gather(data, "Protein", "time", c(1:9)))
View(tidyr::gather(data, "Protein", "time", c(2:9)))
View(tidyr::gather(data, "Protein", "abundance", c(2:9)))
View(tidyr::gather(data, "Time", "abundance", c(2:9)))
View(tidyr::spread(data, "Protein", "abundance"))
data <- tidyr::gather(data, "Time", "abundance", c(2:9))
View(tidyr::spread(data, "Protein", "abundance"))
data <- tidyr::spread(data, "Protein", "abundance")
ncol(data)-2
unique(colnames(data))
View(data.frame(unique(colnames(data))))
data <- read.csv("~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv")
data$Protein <- as.character(unlist(data$Protein))
data$Protein <- substr(data$Protein, 3, nchar(data$Protein))
View(data.frame(unique(data$Protein))
View(data.frame(unique(data$Protein)))
data <- read.csv("~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv")
data$silo <- substr(data$Protein,1,1)
data$Protein <- as.character(unlist(data$Protein))
data$Protein <- substr(data$Protein, 3, nchar(data$Protein))
data <- tidyr::gather(data, "Time", "abundance", c(2:9))
data <- tidyr::spread(data, "Protein", "abundance")
View(data)
ASCA_X <- data[,-c(1:2)]
ASCA_F <- data[,1:2]
View(ASCA_X)
View(ASCA_F)
class(ASCA_F$silo)
class(ASCA_F$Time)
ASCA_F$silo <- as.numeric(ASCA_F$silo)
ASCA_F$Time <- as.numeric(substr(ASCA_F$Time,2,nchar(ASCA_F$Time))
ASCA_F$Time <- as.numeric(substr(ASCA_F$Time,2,nchar(ASCA_F$Time)))
class(ASCA_X$ALBU_BOVINA)
class(ASCA_X$ALBU_BOVIN)
View(ASCAF)
ASCA <- ASCA.Calculate(ASCA_X, ASCA_F, equation.elements = "1,2,12", scaling = FALSE)
ASCA_X <- as.matrix(data[,-c(1:2)])
ASCA_F <- as.matrix(data[,1:2])
ASCA_F$silo <- as.numeric(ASCA_F$silo)
ASCA_F$Time <- as.numeric(substr(ASCA_F$Time,2,nchar(ASCA_F$Time)))
View(ASCA_X)
class(ASCA_X$ALBU_BOVIN)
class(ASCA_X[,1])
class(ASCA_F[,1])
ASCA_F[,1] <- as.numeric(ASCA_F[,1])
class(ASCA_F[,1])
ASCA_F[,1] <- as.numeric(unlist(ASCA_F[,1]))
class(ASCA_F[,1])
class(ASCA_F[,1]) <- "numeric"
class(ASCA_F[,1])
ASCA_F <- data[,1:2]
ASCA_F$silo <- as.numeric(ASCA_F$silo)
ASCA_F$Time <- as.numeric(substr(ASCA_F$Time,2,nchar(ASCA_F$Time)))
ASCA_F<- as.matrix(ASCA_F)
class(ASCA_F[,1])
class(ASCA_F[,2])
ASCA <- ASCA.Calculate(ASCA_X, ASCA_F, equation.elements = "1,2,12", scaling = FALSE)
ASCA <- ASCA.Calculate(ASCA_X, ASCA_F, equation.elements = "1,2,12", scaling = FALSE, na.rm = TRUE)
View(ASCA_X[complete.cases(ASCA_X),])
View(na.omit(ASCA_X))
data <- read.csv("~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv")
#create silo column
data$silo <- substr(data$Protein,1,1)
#change class of protein column from factor to character
data$Protein <- as.character(unlist(data$Protein))
#remove the silo identifier from the protein names
data$Protein <- substr(data$Protein, 3, nchar(data$Protein))
View(data)
data <- tidyr::gather(data, "Time", "abundance", c(2:9))
data <- tidyr::spread(data, "Protein", "abundance")
library("MetStaT", lib.loc="~/Library/R/3.4/library")
## use the data matrix, 'ASCAX', and an experimental design matrix, 'ASCAF'
data(ASCAdata)
ASCA <- ASCA.Calculate(ASCAX, ASCAF, equation.elements = "1,2,12", scaling = FALSE)
## plot the results
ASCA.Plot(ASCA)
ASCA.PlotScoresPerLevel(ASCA)
ASCA
ASCA.Plot(ASCA)
ASCA.PlotLoadings(ASCA)
ASCA.PlotScores(ASCA)
View(ASCAF)
ASCA.PlotScoresPerLevel(ASCA)
ASCA <- ASCA.Calculate(ASCAX, ASCAF, equation.elements = "1,2,12", scaling = FALSE)
ASCA.PlotScoresPerLevel(ASCA)
ASCA.GetSummary(ASCA)
ASCA.PlotScoresPerLevel(ASCA, ee = "2", pcs = "1,2")
ASCA.PlotScoresPerLevel(ASCA, ee = "1", pcs = "1,2")
ASCA.PlotLoadings(ASCA, ee = "1", pcs="1,2")
ASCA.PlotScores(asca, ee = "1", PCs = "1,2")
ASCA.PlotScores(ASCA, ee = "1", PCs = "1,2")
ASCA.PlotScores(ASCA, ee = "2", PCs = "1,2")
View(ASCA)
View(data.frame(ASCA))
View(data.frame(ASCA[1]))
View(data.frame(ASCA[2]))
ASCA
ASCA.PlotScoresPerLevel(ASCA, ee = "1", pcs = "1,2")
View(ASCAF)
View(rbind(ASCAF,ASCAX))
View(cbind(ASCAF,ASCAX))
ASCA.PlotScoresPerLevel(ASCA, ee = "1,2", pcs = "1,2")
ASCA.PlotScoresPerLevel(ASCA, ee = "12", pcs = "1,2")
ASCA.DoPermutationTest(ASCA, perm=1000)
ASCA.PlotScoresPerLevel(ASCA, ee = "1", pcs = "1,2")
View(data)
data$silo <- as.numeric(data$silo)
#change time column class to numeric; exclude the X with the substr command
data$Time <- as.numeric(substr(data$Time,2,nchar(data$Time)))
write.csv(data, "~/Documents/GitHub/OysterSeedProject/analysis/ASCA/ASCA_shellytest/silo3_9_reformat4MetabA.csv", row.names = FALSE, quote = FALSE)
data$sample <- paste("S",data$silo,"T",data$Time, sep = "")
View(data)
data <- data[,c(ncol(data),1:ncol(data)-1)]
View(data)
ncol(data)
write.csv(data, "~/Documents/GitHub/OysterSeedProject/analysis/ASCA/ASCA_shellytest/silo3_9_reformat4MetabA.csv", row.names = FALSE, quote = FALSE)
max(data[,3:ncol(data)])
max(data[,3:ncol(data)], na.rm = TRUE)
min(data[,3:ncol(data)], na.rm = TRUE)
min(data[which(data[,3:ncol(data)!=0]),3:ncol(data)], na.rm = TRUE)
min(data[which(data[,3:ncol(data)!=0]),], na.rm = TRUE)
min(data[which(data[,3:ncol(data)] !=0),3:ncol(data)], na.rm = TRUE)
min(data[which(data[,3:ncol(data)] !=0),], na.rm = TRUE)
min(data[,which(data[,3:ncol(data)] < 0)], na.rm = TRUE)
View(data[,which(data[,3:ncol(data)] < 0)])
View(data[which(data[,3:ncol(data)] < 0),])
View(data[,which(data[,3:ncol(data)] < 0)])
View(as.list(data[,3:ncol(data)]))
View(as.list(data[,4:ncol(data)]))
View(as.list(data[,4:ncol(data)] > 0))
min(as.list(data[,4:ncol(data)] > 0))
min(as.vector(data[,4:ncol(data)] > 0))
min(as.vector(data[,4:ncol(data)] > 0), na.rm = TRUE)
min(as.vector(data[,4:ncol(data)]) > 0, na.rm = TRUE)
View(as.vector(data[,4:ncol(data)]) > 0)
min(data[data > 0)], na.rm = TRUE)
min(data[data > 0], na.rm = TRUE)
min(data[data[,4:ncol(data)] > 0], na.rm = TRUE)
min(data[data > 0], na.rm = TRUE)
data[is.na(data)] <- 0.1
ASCA_X <- as.matrix(data[,-c(1:3)])
#create matrix to pass to ASCA command with only the silo and time info
ASCA_F <- as.matrix(data[,2:3])
ASCA <- ASCA.Calculate(ASCA_X, ASCA_F, equation.elements = "1,2,12", scaling = FALSE)
library(MetStaT)
ASCA <- ASCA.Calculate(ASCA_X, ASCA_F, equation.elements = "1,2,12", scaling = FALSE)
ASCA.PlotScoresPerLevel(ASCA, ee = "1", pcs = "1,2")
ASCA.PlotScoresPerLevel(ASCA, ee = "12", pcs = "1,2")
ASCA.PlotScoresPerLevel(ASCA, ee = "2", pcs = "1,2")
ASCA
data <- read.csv("~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv")
View(data)
data$silo <- substr(data$Protein,1,1)
data$Protein <- as.character(unlist(data$Protein))
data$Protein <- substr(data$Protein, 3, nchar(data$Protein))
View(data)
data <- tidyr::gather(data, "Time", "abundance", c(2:9))
data <- read.csv("~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv")
#create silo column
data$silo <- substr(data$Protein,1,1)
#change class of protein column from factor to character
data$Protein <- as.character(unlist(data$Protein))
#remove the silo identifier from the protein names
data$Protein <- substr(data$Protein, 3, nchar(data$Protein))
View(data.frame(is.na(data)))
(is.na(data))
View(data[which(is.na(data)),]
View(data[which(is.na(data)),])
data <- tidyr::gather(data, "Time", "abundance", c(2:9))
View(data[which(is.na(data)),])
data <- tidyr::spread(data, "Protein", "abundance")
View(data[which(is.na(data)),])
#read in Oyster Temp. protein data frame
data <- read.csv("~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv")
#create silo column
data$silo <- substr(data$Protein,1,1)
#change class of protein column from factor to character
data$Protein <- as.character(unlist(data$Protein))
#remove the silo identifier from the protein names
data$Protein <- substr(data$Protein, 3, nchar(data$Protein))
#Change table orientation so that all abundances are listed in one column
#and time points are listed down a column
#In this command, we only want to apply it to the timepoint columns that
#have abundance values and keep the protein and silo columns unchanged
#so we use c(2:9) to select for timepoint columns with abundance values only
data <- tidyr::gather(data, "Time", "abundance", c(2:9))
#Change the table orientation again so that proteins are listed across the top
#This command will condense the proteins so that only unique proteins are listed
#across the top
data <- tidyr::spread(data, "Protein", "abundance")
#change silo column class to numeric
data$silo <- as.numeric(data$silo)
#change time column class to numeric; exclude the X with the substr command
data$Time <- as.numeric(substr(data$Time,2,nchar(data$Time)))
#format and export table for metaboanalyst
data$sample <- paste("S",data$silo,"T",data$Time, sep = "")
#move sample columns to first column
data <- data[,c(ncol(data),1:ncol(data)-1)]
#replace NAs with non-zero value so we can run ASCA
data[is.na(data)] <- 0.1
write.csv(data, "~/Documents/GitHub/OysterSeedProject/analysis/ASCA/ASCA_shellytest/silo3_9_reformat4MetabA.csv", row.names = FALSE, quote = FALSE)
