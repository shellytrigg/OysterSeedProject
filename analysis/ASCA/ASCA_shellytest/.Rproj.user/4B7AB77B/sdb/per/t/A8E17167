{
    "contents" : "library(dplyr)\nlibrary(tidyr)\nlibrary(MetStaT)\n\n\n#Messing around with ASCA example:\n## use the data matrix, 'ASCAX', and an experimental design matrix, 'ASCAF'\ndata(ASCAdata)\nASCA <- ASCA.Calculate(ASCAX, ASCAF, equation.elements = \"1,2,12\", scaling = FALSE)\n\n#Check format of example data file\nView(ASCAX)\n#There are 60 rows and 4 columns\n\n#Check format of example levels file\nView(ASCAF)\n#there are 60 rows and two factors; (i.e. first column could be temperature\n#and second column could be timepoint)\n\n## plotting the results\n## plot the loadings of the first two principal components of the first factor (i.e. temp.)\nASCA.PlotLoadings(ASCA, ee = \"1\", pcs=\"1,2\")\n#plot single score plot for the second factor on the first two PCs\nASCA.PlotScores(ASCA, ee = \"2\", PCs = \"1,2\")\n## plot the scores for the first two principal components and the projections of \n## the data for the second factor (i.e. time)\nASCA.PlotScoresPerLevel(ASCA, ee = \"2\", pcs = \"1,2\")\n## the data for the first factor (i.e. temp.)\nASCA.PlotScoresPerLevel(ASCA, ee = \"1\", pcs = \"1,2\")\n## the data for the interaction of factors (i.e. temp. and time interactive effect)\nASCA.PlotScoresPerLevel(ASCA, ee = \"12\", pcs = \"1,2\")\n\n#print ASCA summary showing variance explained per component\nASCA.GetSummary(ASCA)\n\n## Do a permutation test to evaluate the significance to the two factors and the interaction.\nASCA.DoPermutationTest(ASCA, perm=1000)\n#output\n#1     2    12\n#0.001 0.003 0.191\n#means that factor 1 and factor 2 both have significant effects on molecules, but the interaction of the factors does not have a significant effect\n\n\n\n#read in Oyster Temp. protein data frame\ndata <- read.csv(\"~/Documents/GitHub/OysterSeedProject/analysis/kmeans/Silo3_and_9/silo3and9.csv\")\n#create silo column\ndata$silo <- substr(data$Protein,1,1)\n#change class of protein column from factor to character\ndata$Protein <- as.character(unlist(data$Protein))\n#remove the silo identifier from the protein names\ndata$Protein <- substr(data$Protein, 3, nchar(data$Protein))\n#Change table orientation so that all abundances are listed in one column \n#and time points are listed down a column\n#In this command, we only want to apply it to the timepoint columns that \n#have abundance values and keep the protein and silo columns unchanged\n#so we use c(2:9) to select for timepoint columns with abundance values only\ndata <- tidyr::gather(data, \"Time\", \"abundance\", c(2:9))\n#Change the table orientation again so that proteins are listed across the top\n#This command will condense the proteins so that only unique proteins are listed\n#across the top\ndata <- tidyr::spread(data, \"Protein\", \"abundance\")\n#change silo column class to numeric\ndata$silo <- as.numeric(data$silo)\n#change time column class to numeric; exclude the X with the substr command\ndata$Time <- as.numeric(substr(data$Time,2,nchar(data$Time)))\n\n#format and export table for metaboanalyst\ndata$sample <- paste(\"S\",data$silo,\"T\",data$Time, sep = \"\")\n#move sample columns to first column\ndata <- data[,c(ncol(data),1:ncol(data)-1)]\nwrite.csv(data, \"~/Documents/GitHub/OysterSeedProject/analysis/ASCA/ASCA_shellytest/silo3_9_reformat4MetabA.csv\", row.names = FALSE, quote = FALSE)\n\n#find max abundance value\nmax(data[,4:ncol(data)], na.rm = TRUE)\n# 379\n\n#find min abundance value\nmin(data[data > 0], na.rm = TRUE)\n#0.5\n#replace NAs with non-zero value so we can run ASCA\ndata[is.na(data)] <- 0.1\n\n\n#create matrix to pass to ASCA command, excluding the silo and time info\nASCA_X <- as.matrix(data[,-c(1:3)])\n#create matrix to pass to ASCA command with only the silo and time info\nASCA_F <- as.matrix(data[,2:3])\n\n\n#Run ASCA command\nASCA <- ASCA.Calculate(ASCA_X, ASCA_F, equation.elements = \"1,2,12\", scaling = FALSE)\n\n\n\n",
    "created" : 1538244019239.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "655954361",
    "id" : "A8E17167",
    "lastKnownWriteTime" : 1538330644,
    "path" : "~/Documents/GitHub/OysterSeedProject/analysis/ASCA/ASCA_shellytest/ASCA_test.R",
    "project_path" : "ASCA_test.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}